<h1>Personal Finance Health Report</h1>

<h2>A. Overall Profile Review</h2>
<p>{{ overall_profile_review }}</p>

<h2>B. Commendable Areas</h2>
{% if commendable_areas and commendable_areas|length > 0 %}
  <ol>
  {% for area in commendable_areas %}
    <li>
    <strong>{{ area.header }}</strong><br>
       <div style="margin-left: 0.5em;">
        <ul>
          <li><p>{{ area.current_scenario }}</p></li>
        </ul>
      </div>
    </li>
  {% endfor %}
  </ol>
{% else %}
  <blockquote>No particularly strong positive areas to highlight.</blockquote>
{% endif %}

<h2>C. Areas for Improvement</h2>
{% if areas_for_improvement and areas_for_improvement|length > 0 %}
  <ol>
  {% for item in areas_for_improvement %}
    <li>
      <strong>{{ item.header }}</strong><br>
      <div style="margin-left: 0.5em;">
        <ul>
          <li><p>Current Scenario: {{ item.current_scenario }}</p></li>
          <li><p>Actionable: {{ item.actionable }}</p></li>
        </ul>
      </div>
    </li>
  {% endfor %}
  </ol>
{% else %}
  <blockquote><em>No immediate areas for improvement detected.</em></blockquote>
{% endif %}

<h2>D. Summary</h2>
<p>{{ summary }}</p>

<div class="page-break"></div>

<h2>E. Glossary</h2>
{% if glossary %}
<ol>
  {% for var, info in glossary.items() %}
  <li>
    <h3>{{ info.term }}</h3>
    <blockquote> {{ info.definition }}</blockquote>
    <ul style="margin-left:1em; list-style-type:disc;">
      <li><strong>Formula:</strong> {{ info.formula }}</li>
      <li><strong>Significance:</strong> {{ info.significance }}</li>
    </ul>
  </li>
  {% endfor %}
</ol>
{% else %}
<blockquote>No glossary available.</blockquote>
{% endif %}

<h2>F. Appendix</h2>
<table>
  <thead>
    <tr>
      <th>Metric</th>
      <th>Weight Assigned</th>
      <th>Benchmark Value</th>
      <th>User Value</th>
      <th>Points Awarded</th>
    </tr>
  </thead>
  <tbody>
    {% for row in appendix %}
      {% if row.metric|trim|lower == 'total' %}
      <tr>
        <td><strong>{{ row.metric }}</strong></td>
        <td><strong>{{ row.weight }}</strong></td>
        <td><strong>{{ row.benchmark }}</strong></td>
        <td><strong>{{ row.user_value }}</strong></td>
        <td><strong>{{ row.points_awarded }}</strong></td>
      </tr>
      {% else %}
      <tr>
        <td>{{ row.metric }}</td>
        <td>{{ row.weight }}</td>
        <td>{{ row.benchmark }}</td>
        <td>{{ row.user_value }}</td>
        <td>{{ row.points_awarded }}</td>
      </tr>
      {% endif %}
    {% endfor %}
  </tbody>
</table>
